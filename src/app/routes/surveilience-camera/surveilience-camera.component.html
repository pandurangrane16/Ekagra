<div class="row">
    <div class="col-md-3">
        <div class="card mt-1">
            <div class="card-body">
                <mat-form-field appearance="outline" class="w-100">
                    <mat-icon matPrefix>search</mat-icon>
                    <input matInput placeholder="Placeholder"  [(ngModel)]="siteSearchText" (ngModelChange)="onSearchTextChange($event)"> 
                    <mat-icon matSuffix>filter_list</mat-icon>
                </mat-form-field> 

   <mat-accordion [multi]="true">
  <mat-expansion-panel *ngFor="let location of locations" [expanded]="location.expanded">
    <mat-expansion-panel-header>
      <mat-panel-title>{{ location.locationName }}</mat-panel-title>
    </mat-expansion-panel-header>
    <ul class="list-unstyled ps-3">
      <li
        *ngFor="let site of location.sites | siteSearch:siteSearchText"
        class="py-1 site-name"
        (click)="onSiteClick(site.siteId)"
        style="cursor: pointer;"
      >
        {{ site.siteName }}
      </li>
    </ul>
  </mat-expansion-panel>
</mat-accordion>

            </div>
        </div>
    </div>
    <div class="col-md-9">
        <div class="row">

             

<div *ngIf="loading" class="loader-container">
  <mat-spinner></mat-spinner> <!-- Or your custom loader -->
</div>

<!-- Right side streams -->
<div *ngIf="!loading">
  <ng-container *ngIf="activeStreams.length > 0; else noStreams">
    <div class="row">
      <div *ngFor="let stream of activeStreams" class="col-md-6 mb-3">
        <div class="card h-100 shadow-sm stream-tile">
          <div class="card-header d-flex justify-content-between align-items-center p-2">
              <span class="fw-bold">
                {{ stream.cameraName }} / {{ stream.siteName }}
              </span>
            <button
              class="btn btn-sm btn-outline-danger"
              (click)="onClosePreview(stream.siteId)"
              title="Close Stream"
            >
              âœ–
            </button>
          </div>
          <div class="card-body p-2">
            <app-video-stream-player [streamUrl]="stream.streamUrl"></app-video-stream-player>
          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <ng-template #noStreams>
    <div class="alert alert-info text-center mt-3">
      No streams selected.
    </div>
  </ng-template>
</div>



<!-- 
           <div *ngFor="let cam of camera" class="col-md-6 mt-1 mb-1">
                <div class="card" [ngClass]="{ fullscreen: cam.expanded }">
                <div class="card-body">  
                <div class="title d-flex align-items-start justify-content-between mb-1">
                    <span>
                        {{cam.name}}
                    </span>
                    <span class="actions">
                        <a class="me-1"><img src="assets/img/Share-Link.png"/></a>
                        <a class="me-1" (click)="toggleExpand(cam)"> <img src="assets/img/Minimize-2.png"></a>
                        <a><img src="assets/img/Delete-Circle.png"></a>
                    </span>
                </div>
               
                 <div class="preview-container" (click)="onSiteClick(cam.siteId)">
         <app-video-stream-player
  *ngIf="cam.safeStreamUrl"
  [streamUrl]="cam.safeStreamUrl"
></app-video-stream-player>
        <div class="preview-overlay">Preview</div>
      </div>
            </div>
        </div>
            </div> -->

<!-- <div *ngFor="let cam of camera | slice:0:4" class="col-md-6 mt-1 mb-1">
  <div class="card" [ngClass]="{ fullscreen: cam.expanded }">
    <div class="card-body">
      <div class="title d-flex align-items-start justify-content-between mb-1">
        <span>{{ cam.name }}</span>
        <span class="actions">
          <a class="me-1"><img src="assets/img/Share-Link.png"/></a>
          <a class="me-1" (click)="toggleExpand(cam)"> 
            <img src="assets/img/Minimize-2.png">
          </a>
          <a><img src="assets/img/Delete-Circle.png"></a>
        </span>
      </div>

      <app-video-stream-player
        *ngIf="cam.safeStreamUrl"
        [streamUrl]="cam.safeStreamUrl"
      ></app-video-stream-player>

    </div>
  </div>
</div> -->



        </div>
    </div>
</div>
<div *ngIf="loading" class="loader-overlay">
  <div class="spinner"></div>
</div>