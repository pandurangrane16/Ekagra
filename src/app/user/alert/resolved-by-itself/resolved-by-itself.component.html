<div class="dialog-header">
    <div class="row dialog-title">
        <div class="col-md-9 text-left">
            <span class="dialog-title">Resolved By Itself</span>
        </div>
        <div class="col-md-3 text-right">
            <button mat-icon-button matTooltip="Back to List" aria-label="Back" (click)="close()">
                <mat-icon>close</mat-icon>
            </button>
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-3">
            Policy Name :
        </div>
        <div class="col-md-9">
            <span style="color:yellow;">{{data.policyName}} </span>
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
            Ticket Number : 
        </div>
        <div class="col-md-9">
            <span style="color:yellow;">{{data.allData.ticketNo}} </span>
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
            Site Name : 
        </div>
        <div class="col-md-9">
            <span style="color:yellow;">{{data.allData.siteName}} </span>
        </div>
    </div>
</div>
<div class="pageWrapper">
    <mat-card class="cardWithShadow theme-card">

        <mat-card-content>
            <form [formGroup]="form">
                <div class="row">
                    <div class="col-md-12">
                        <app-cm-textarea [formGroup]="form" [controlName]="'remarks'"
                            [_inputData]="inputFields.remarks">
                        </app-cm-textarea>
                    </div>
                </div>
                <hr>
                <!-- <div class="row">
                        <label>Attach File</label>
                        <div class="col-md-12">
                            <input type="file"/>
                        </div>
                    </div> -->

                <!-- <div class="row">
                    <label>Attach File</label>
                    <div class="col-6 d-flex gap-2 flex-row align-items-center">
                        <button mat-raised-button color="primary" class="btn-primary" (click)="fileInput.click()">
                            <mat-icon>attach_file</mat-icon>
                            Choose File
                        </button>
                        <span [matTooltip]="fileName">{{ fileName || 'No file selected' }}</span>

                        <input type="file" #fileInput hidden (change)="onFileSelected($event)" />
                    </div>
                </div> -->


                <!-- ✅ Multiple File Upload Section -->
        <div class="row">
      <label>
        Attach File <small>(pdf, docx, xlsx, jpg, png – max 5 MB)</small>
        </label>
          <div class="col-md-12 d-flex flex-column gap-2">
            <div
              class="d-flex align-items-center gap-2"
              *ngFor="let slot of fileSlots; let i = index"
            >
              <!-- Choose File -->
              <button
                mat-raised-button
                color="primary"
                class="btn-primary"
                (click)="triggerFileInput(i)"
                type="button"
              >
                <mat-icon>attach_file</mat-icon>
                Choose File
              </button>

              <span class="flex-grow-1" [matTooltip]="slot.names || 'No file selected'">
                {{ slot.names || 'No file selected' }}
              </span>

              <!-- Hidden File Input -->
              <input
                type="file"
                hidden
                #fileInputRef
                (change)="onFileSelected($event, i)"
                multiple
              />

              <!-- Remove Icon -->
              <button
                mat-icon-button
                color="warn"
                *ngIf="fileSlots.length > 1"
                (click)="removeFileSlot(i)"
                aria-label="Remove"
              >
                <mat-icon>remove_circle</mat-icon>
              </button>

              <!-- Add Icon -->
              <button
                mat-icon-button
                color="primary"
                *ngIf="i === fileSlots.length - 1"
                (click)="addFileSlot()"
                aria-label="Add"
              >
                <mat-icon>add_circle</mat-icon>
              </button>
            </div>
          </div>
        </div>


        

                <div class="dialog-actions mt-2">

                    <button mat-stroked-button (click)="close()">Cancel</button>

                    <button mat-flat-button class="btn-primary" (click)="submitAction()">Submit</button>


                </div>
            </form>
        </mat-card-content>

    </mat-card>
</div>